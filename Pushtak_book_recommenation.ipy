{
  "cells": [
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "-IQMASE0gqZh"
      },
      "outputs": [],
      "source": [
        "import pandas as pd\n",
        "import numpy as np\n",
        "users = pd.read_csv(\"Users.csv\", sep=';',encoding=\"latin-1\", error_bad_lines=False)\n",
        "ratings = pd.read_csv(\"Book-Ratings.csv\", sep=';', encoding=\"latin-1\", error_bad_lines=False)\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 206
        },
        "id": "OxPCf__xKXFE",
        "outputId": "00876a43-463b-4c89-810f-e408b8c24e55"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>User-ID</th>\n",
              "      <th>Location</th>\n",
              "      <th>Age</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>1</td>\n",
              "      <td>nyc, new york, usa</td>\n",
              "      <td>NaN</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>2</td>\n",
              "      <td>stockton, california, usa</td>\n",
              "      <td>18.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>3</td>\n",
              "      <td>moscow, yukon territory, russia</td>\n",
              "      <td>NaN</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>4</td>\n",
              "      <td>porto, v.n.gaia, portugal</td>\n",
              "      <td>17.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>5</td>\n",
              "      <td>farnborough, hants, united kingdom</td>\n",
              "      <td>NaN</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>"
            ],
            "text/plain": [
              "   User-ID                            Location   Age\n",
              "0        1                  nyc, new york, usa   NaN\n",
              "1        2           stockton, california, usa  18.0\n",
              "2        3     moscow, yukon territory, russia   NaN\n",
              "3        4           porto, v.n.gaia, portugal  17.0\n",
              "4        5  farnborough, hants, united kingdom   NaN"
            ]
          },
          "execution_count": 2,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "users.head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "IapPby1fKnP6",
        "outputId": "8847fa99-2d4d-4d40-c72b-ebec90209072"
      },
      "outputs": [
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "b'Skipping line 6452: expected 8 fields, saw 9\\nSkipping line 43667: expected 8 fields, saw 10\\nSkipping line 51751: expected 8 fields, saw 9\\n'\n",
            "b'Skipping line 92038: expected 8 fields, saw 9\\nSkipping line 104319: expected 8 fields, saw 9\\nSkipping line 121768: expected 8 fields, saw 9\\n'\n",
            "b'Skipping line 144058: expected 8 fields, saw 9\\nSkipping line 150789: expected 8 fields, saw 9\\nSkipping line 157128: expected 8 fields, saw 9\\nSkipping line 180189: expected 8 fields, saw 9\\nSkipping line 185738: expected 8 fields, saw 9\\n'\n",
            "b'Skipping line 209388: expected 8 fields, saw 9\\nSkipping line 220626: expected 8 fields, saw 9\\nSkipping line 227933: expected 8 fields, saw 11\\nSkipping line 228957: expected 8 fields, saw 10\\nSkipping line 245933: expected 8 fields, saw 9\\nSkipping line 251296: expected 8 fields, saw 9\\nSkipping line 259941: expected 8 fields, saw 9\\nSkipping line 261529: expected 8 fields, saw 9\\n'\n",
            "C:\\Users\\MadhuMurali\\anaconda3\\lib\\site-packages\\IPython\\core\\interactiveshell.py:3071: DtypeWarning: Columns (3) have mixed types.Specify dtype option on import or set low_memory=False.\n",
            "  has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n"
          ]
        }
      ],
      "source": [
        "books = pd.read_csv(\"Books.csv\", sep=';', encoding=\"latin-1\", error_bad_lines=False)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 478
        },
        "id": "jRzzgr-YUwCm",
        "outputId": "fbef7491-9459-4741-def3-5a324ee82149"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>ISBN</th>\n",
              "      <th>Book-Title</th>\n",
              "      <th>Book-Author</th>\n",
              "      <th>Year-Of-Publication</th>\n",
              "      <th>Publisher</th>\n",
              "      <th>Image-URL-S</th>\n",
              "      <th>Image-URL-M</th>\n",
              "      <th>Image-URL-L</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>0195153448</td>\n",
              "      <td>Classical Mythology</td>\n",
              "      <td>Mark P. O. Morford</td>\n",
              "      <td>2002</td>\n",
              "      <td>Oxford University Press</td>\n",
              "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
              "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
              "      <td>http://images.amazon.com/images/P/0195153448.0...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>0002005018</td>\n",
              "      <td>Clara Callan</td>\n",
              "      <td>Richard Bruce Wright</td>\n",
              "      <td>2001</td>\n",
              "      <td>HarperFlamingo Canada</td>\n",
              "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
              "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
              "      <td>http://images.amazon.com/images/P/0002005018.0...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>0060973129</td>\n",
              "      <td>Decision in Normandy</td>\n",
              "      <td>Carlo D'Este</td>\n",
              "      <td>1991</td>\n",
              "      <td>HarperPerennial</td>\n",
              "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
              "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
              "      <td>http://images.amazon.com/images/P/0060973129.0...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>0374157065</td>\n",
              "      <td>Flu: The Story of the Great Influenza Pandemic...</td>\n",
              "      <td>Gina Bari Kolata</td>\n",
              "      <td>1999</td>\n",
              "      <td>Farrar Straus Giroux</td>\n",
              "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
              "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
              "      <td>http://images.amazon.com/images/P/0374157065.0...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>0393045218</td>\n",
              "      <td>The Mummies of Urumchi</td>\n",
              "      <td>E. J. W. Barber</td>\n",
              "      <td>1999</td>\n",
              "      <td>W. W. Norton &amp;amp; Company</td>\n",
              "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
              "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
              "      <td>http://images.amazon.com/images/P/0393045218.0...</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>"
            ],
            "text/plain": [
              "         ISBN                                         Book-Title  \\\n",
              "0  0195153448                                Classical Mythology   \n",
              "1  0002005018                                       Clara Callan   \n",
              "2  0060973129                               Decision in Normandy   \n",
              "3  0374157065  Flu: The Story of the Great Influenza Pandemic...   \n",
              "4  0393045218                             The Mummies of Urumchi   \n",
              "\n",
              "            Book-Author Year-Of-Publication                   Publisher  \\\n",
              "0    Mark P. O. Morford                2002     Oxford University Press   \n",
              "1  Richard Bruce Wright                2001       HarperFlamingo Canada   \n",
              "2          Carlo D'Este                1991             HarperPerennial   \n",
              "3      Gina Bari Kolata                1999        Farrar Straus Giroux   \n",
              "4       E. J. W. Barber                1999  W. W. Norton &amp; Company   \n",
              "\n",
              "                                         Image-URL-S  \\\n",
              "0  http://images.amazon.com/images/P/0195153448.0...   \n",
              "1  http://images.amazon.com/images/P/0002005018.0...   \n",
              "2  http://images.amazon.com/images/P/0060973129.0...   \n",
              "3  http://images.amazon.com/images/P/0374157065.0...   \n",
              "4  http://images.amazon.com/images/P/0393045218.0...   \n",
              "\n",
              "                                         Image-URL-M  \\\n",
              "0  http://images.amazon.com/images/P/0195153448.0...   \n",
              "1  http://images.amazon.com/images/P/0002005018.0...   \n",
              "2  http://images.amazon.com/images/P/0060973129.0...   \n",
              "3  http://images.amazon.com/images/P/0374157065.0...   \n",
              "4  http://images.amazon.com/images/P/0393045218.0...   \n",
              "\n",
              "                                         Image-URL-L  \n",
              "0  http://images.amazon.com/images/P/0195153448.0...  \n",
              "1  http://images.amazon.com/images/P/0002005018.0...  \n",
              "2  http://images.amazon.com/images/P/0060973129.0...  \n",
              "3  http://images.amazon.com/images/P/0374157065.0...  \n",
              "4  http://images.amazon.com/images/P/0393045218.0...  "
            ]
          },
          "execution_count": 4,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "books.head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "s66KFNjfU5ut"
      },
      "outputs": [],
      "source": [
        "books = books[['ISBN', 'Book-Title', 'Book-Author', 'Year-Of-Publication', 'Publisher']]\n",
        "books.rename(columns = {'Book-Title':'title', 'Book-Author':'author', 'Year-Of-Publication':'year', 'Publisher':'publisher'}, inplace=True)\n",
        "users.rename(columns = {'User-ID':'user_id', 'Location':'location', 'Age':'age'}, inplace=True)\n",
        "ratings.rename(columns = {'User-ID':'user_id', 'Book-Rating':'rating'}, inplace=True)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 206
        },
        "id": "Ul34A2wrVDLe",
        "outputId": "a3136278-42d2-4ff0-8b14-aabeacdf634c"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>ISBN</th>\n",
              "      <th>title</th>\n",
              "      <th>author</th>\n",
              "      <th>year</th>\n",
              "      <th>publisher</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>0195153448</td>\n",
              "      <td>Classical Mythology</td>\n",
              "      <td>Mark P. O. Morford</td>\n",
              "      <td>2002</td>\n",
              "      <td>Oxford University Press</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>0002005018</td>\n",
              "      <td>Clara Callan</td>\n",
              "      <td>Richard Bruce Wright</td>\n",
              "      <td>2001</td>\n",
              "      <td>HarperFlamingo Canada</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>0060973129</td>\n",
              "      <td>Decision in Normandy</td>\n",
              "      <td>Carlo D'Este</td>\n",
              "      <td>1991</td>\n",
              "      <td>HarperPerennial</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>0374157065</td>\n",
              "      <td>Flu: The Story of the Great Influenza Pandemic...</td>\n",
              "      <td>Gina Bari Kolata</td>\n",
              "      <td>1999</td>\n",
              "      <td>Farrar Straus Giroux</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>0393045218</td>\n",
              "      <td>The Mummies of Urumchi</td>\n",
              "      <td>E. J. W. Barber</td>\n",
              "      <td>1999</td>\n",
              "      <td>W. W. Norton &amp;amp; Company</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>"
            ],
            "text/plain": [
              "         ISBN                                              title  \\\n",
              "0  0195153448                                Classical Mythology   \n",
              "1  0002005018                                       Clara Callan   \n",
              "2  0060973129                               Decision in Normandy   \n",
              "3  0374157065  Flu: The Story of the Great Influenza Pandemic...   \n",
              "4  0393045218                             The Mummies of Urumchi   \n",
              "\n",
              "                 author  year                   publisher  \n",
              "0    Mark P. O. Morford  2002     Oxford University Press  \n",
              "1  Richard Bruce Wright  2001       HarperFlamingo Canada  \n",
              "2          Carlo D'Este  1991             HarperPerennial  \n",
              "3      Gina Bari Kolata  1999        Farrar Straus Giroux  \n",
              "4       E. J. W. Barber  1999  W. W. Norton &amp; Company  "
            ]
          },
          "execution_count": 6,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "books.head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 206
        },
        "id": "bVdlEn17VOiW",
        "outputId": "3d25a527-7ceb-45b7-b168-fcf12e13385c"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>user_id</th>\n",
              "      <th>location</th>\n",
              "      <th>age</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>1</td>\n",
              "      <td>nyc, new york, usa</td>\n",
              "      <td>NaN</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>2</td>\n",
              "      <td>stockton, california, usa</td>\n",
              "      <td>18.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>3</td>\n",
              "      <td>moscow, yukon territory, russia</td>\n",
              "      <td>NaN</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>4</td>\n",
              "      <td>porto, v.n.gaia, portugal</td>\n",
              "      <td>17.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>5</td>\n",
              "      <td>farnborough, hants, united kingdom</td>\n",
              "      <td>NaN</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>"
            ],
            "text/plain": [
              "   user_id                            location   age\n",
              "0        1                  nyc, new york, usa   NaN\n",
              "1        2           stockton, california, usa  18.0\n",
              "2        3     moscow, yukon territory, russia   NaN\n",
              "3        4           porto, v.n.gaia, portugal  17.0\n",
              "4        5  farnborough, hants, united kingdom   NaN"
            ]
          },
          "execution_count": 7,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "users.head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 206
        },
        "id": "VAh9g9ejVSGG",
        "outputId": "917c1a2e-77e1-4636-91e4-2c00ab490d10"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>user_id</th>\n",
              "      <th>ISBN</th>\n",
              "      <th>rating</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>276725</td>\n",
              "      <td>034545104X</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>276726</td>\n",
              "      <td>0155061224</td>\n",
              "      <td>5</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>276727</td>\n",
              "      <td>0446520802</td>\n",
              "      <td>0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>276729</td>\n",
              "      <td>052165615X</td>\n",
              "      <td>3</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>276729</td>\n",
              "      <td>0521795028</td>\n",
              "      <td>6</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>"
            ],
            "text/plain": [
              "   user_id        ISBN  rating\n",
              "0   276725  034545104X       0\n",
              "1   276726  0155061224       5\n",
              "2   276727  0446520802       0\n",
              "3   276729  052165615X       3\n",
              "4   276729  0521795028       6"
            ]
          },
          "execution_count": 8,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "ratings.head()\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "47vRyM9vZ9Nm",
        "outputId": "647670c4-feba-423e-fc55-1005e40db372"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "(1149780, 3)\n"
          ]
        },
        {
          "data": {
            "text/plain": [
              "11676     13602\n",
              "198711     7550\n",
              "153662     6109\n",
              "98391      5891\n",
              "35859      5850\n",
              "          ...  \n",
              "158698        1\n",
              "17920         1\n",
              "277135        1\n",
              "275086        1\n",
              "187812        1\n",
              "Name: user_id, Length: 105283, dtype: int64"
            ]
          },
          "execution_count": 9,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "print(ratings.shape)\n",
        "ratings['user_id'].value_counts()\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "aiICpDU6wvL_",
        "outputId": "8fc3882c-2b35-4350-f0bb-fdc7538628f1"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "         ISBN                                              title  \\\n",
            "0  0195153448                                Classical Mythology   \n",
            "1  0002005018                                       Clara Callan   \n",
            "2  0060973129                               Decision in Normandy   \n",
            "3  0374157065  Flu: The Story of the Great Influenza Pandemic...   \n",
            "4  0393045218                             The Mummies of Urumchi   \n",
            "\n",
            "                 author  year                   publisher  readScore  \n",
            "0    Mark P. O. Morford  2002     Oxford University Press         19  \n",
            "1  Richard Bruce Wright  2001       HarperFlamingo Canada         93  \n",
            "2          Carlo D'Este  1991             HarperPerennial         81  \n",
            "3      Gina Bari Kolata  1999        Farrar Straus Giroux         93  \n",
            "4       E. J. W. Barber  1999  W. W. Norton &amp; Company         52  \n",
            "   user_id                            location   age  readScore\n",
            "0        1                  nyc, new york, usa   NaN         10\n",
            "1        2           stockton, california, usa  18.0         61\n",
            "2        3     moscow, yukon territory, russia   NaN          6\n",
            "3        4           porto, v.n.gaia, portugal  17.0         77\n",
            "4        5  farnborough, hants, united kingdom   NaN         41\n"
          ]
        }
      ],
      "source": [
        "read_score=np.random.randint(1,100,size=(271360,1))\n",
        "books['readScore']=read_score\n",
        "print(books.head())\n",
        "userread_score=np.random.randint(1,100,size=(278858,1))\n",
        "users['readScore']=userread_score\n",
        "print(users.head())"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "GlchHQj1aKvu",
        "outputId": "1d1ea3e5-ed5f-49e1-ffc6-0a65ba60ccc3"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "11676      True\n",
            "198711     True\n",
            "153662     True\n",
            "98391      True\n",
            "35859      True\n",
            "          ...  \n",
            "158698    False\n",
            "17920     False\n",
            "277135    False\n",
            "275086    False\n",
            "187812    False\n",
            "Name: user_id, Length: 105283, dtype: bool\n"
          ]
        }
      ],
      "source": [
        "x = ratings['user_id'].value_counts() > 200\n",
        "print(x)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "0ZubwkCRwvMB",
        "outputId": "d240e2ba-3ffa-41bb-d6a7-dcce19cee39c"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "(899,)\n",
            "         user_id        ISBN  rating\n",
            "1456      277427  002542730X      10\n",
            "1457      277427  0026217457       0\n",
            "1458      277427  003008685X       8\n",
            "1459      277427  0030615321       0\n",
            "1460      277427  0060002050       0\n",
            "...          ...         ...     ...\n",
            "1147612   275970  3829021860       0\n",
            "1147613   275970  4770019572       0\n",
            "1147614   275970   896086097       0\n",
            "1147615   275970  9626340762       8\n",
            "1147616   275970  9626344990       0\n",
            "\n",
            "[526356 rows x 3 columns]\n"
          ]
        }
      ],
      "source": [
        "y = x[x].index  #user_ids\n",
        "print(y.shape)\n",
        "ratings = ratings[ratings['user_id'].isin(y)]\n",
        "print(ratings)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "BdeM7CLuaPwf",
        "outputId": "f205e841-dd7a-4b34-c6e2-411927499041"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "      user_id        ISBN  rating\n",
            "1456   277427  002542730X      10\n",
            "1457   277427  0026217457       0\n",
            "1458   277427  003008685X       8\n",
            "1459   277427  0030615321       0\n",
            "1460   277427  0060002050       0\n",
            "         ISBN                                              title  \\\n",
            "0  0195153448                                Classical Mythology   \n",
            "1  0002005018                                       Clara Callan   \n",
            "2  0060973129                               Decision in Normandy   \n",
            "3  0374157065  Flu: The Story of the Great Influenza Pandemic...   \n",
            "4  0393045218                             The Mummies of Urumchi   \n",
            "\n",
            "                 author  year                   publisher  readScore  \n",
            "0    Mark P. O. Morford  2002     Oxford University Press         19  \n",
            "1  Richard Bruce Wright  2001       HarperFlamingo Canada         93  \n",
            "2          Carlo D'Este  1991             HarperPerennial         81  \n",
            "3      Gina Bari Kolata  1999        Farrar Straus Giroux         93  \n",
            "4       E. J. W. Barber  1999  W. W. Norton &amp; Company         52  \n",
            "0         Politically Correct Bedtime Stories: Modern Ta...\n",
            "1         Politically Correct Bedtime Stories: Modern Ta...\n",
            "2         Politically Correct Bedtime Stories: Modern Ta...\n",
            "3         Politically Correct Bedtime Stories: Modern Ta...\n",
            "4         Politically Correct Bedtime Stories: Modern Ta...\n",
            "                                ...                        \n",
            "487666                                     Here Is New York\n",
            "487667    There's a Porcupine in My Outhouse: Misadventu...\n",
            "487668                                           Die Biene.\n",
            "487669                                       The Penis Book\n",
            "487670                                              Musashi\n",
            "Name: title, Length: 487671, dtype: object\n"
          ]
        }
      ],
      "source": [
        "print(ratings.head())\n",
        "print(books.head())\n",
        "rating_with_books = ratings.merge(books, on='ISBN')\n",
        "rating_with_books.head()\n",
        "print(rating_with_books['title'])"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Fzr_mRi0aSl9",
        "outputId": "eaa98669-cb98-49f1-f660-4ad19ca2dd41",
        "scrolled": false
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "                                                    title  rating\n",
            "0        A Light in the Storm: The Civil War Diary of ...       2\n",
            "1                                   Always Have Popsicles       1\n",
            "2                    Apple Magic (The Collector's series)       1\n",
            "3        Beyond IBM: Leadership Marketing and Finance ...       1\n",
            "4        Clifford Visita El Hospital (Clifford El Gran...       1\n",
            "...                                                   ...     ...\n",
            "160264  Ã?Â?ber die Pflicht zum Ungehorsam gegen den S...       3\n",
            "160265                                      Ã?Â?lpiraten.       1\n",
            "160266                     Ã?Â?rger mit Produkt X. Roman.       1\n",
            "160267                              Ã?Â?stlich der Berge.       1\n",
            "160268                                  Ã?Â?thique en toc       1\n",
            "\n",
            "[160269 rows x 2 columns]\n"
          ]
        }
      ],
      "source": [
        "number_rating = rating_with_books.groupby('title')['rating'].count().reset_index()\n",
        "print(number_rating)\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "qUWO0Bo1wvMC",
        "outputId": "9107f34c-02f3-41a3-b2e5-3c52055e2623"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Index(['title', 'number_of_ratings'], dtype='object')\n",
            "Index(['user_id', 'ISBN', 'rating', 'title', 'author', 'year', 'publisher',\n",
            "       'readScore'],\n",
            "      dtype='object')\n"
          ]
        }
      ],
      "source": [
        "number_rating.rename(columns= {'rating':'number_of_ratings'}, inplace=True)\n",
        "print(number_rating.columns)\n",
        "print(rating_with_books.columns)\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "_JT-Rg9kwvMD",
        "outputId": "9c5a3d9b-884c-44fe-a46f-e5d01d35d384"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "        user_id        ISBN  rating  \\\n",
            "0        277427  002542730X      10   \n",
            "1          3363  002542730X       0   \n",
            "2         11676  002542730X       6   \n",
            "3         12538  002542730X      10   \n",
            "4         13552  002542730X       0   \n",
            "...         ...         ...     ...   \n",
            "487666   275970  1892145022       0   \n",
            "487667   275970  1931868123       0   \n",
            "487668   275970  3411086211      10   \n",
            "487669   275970  3829021860       0   \n",
            "487670   275970  4770019572       0   \n",
            "\n",
            "                                                    title  \\\n",
            "0       Politically Correct Bedtime Stories: Modern Ta...   \n",
            "1       Politically Correct Bedtime Stories: Modern Ta...   \n",
            "2       Politically Correct Bedtime Stories: Modern Ta...   \n",
            "3       Politically Correct Bedtime Stories: Modern Ta...   \n",
            "4       Politically Correct Bedtime Stories: Modern Ta...   \n",
            "...                                                   ...   \n",
            "487666                                   Here Is New York   \n",
            "487667  There's a Porcupine in My Outhouse: Misadventu...   \n",
            "487668                                         Die Biene.   \n",
            "487669                                     The Penis Book   \n",
            "487670                                            Musashi   \n",
            "\n",
            "                               author  year  \\\n",
            "0                   James Finn Garner  1994   \n",
            "1                   James Finn Garner  1994   \n",
            "2                   James Finn Garner  1994   \n",
            "3                   James Finn Garner  1994   \n",
            "4                   James Finn Garner  1994   \n",
            "...                               ...   ...   \n",
            "487666                    E. B. White  1999   \n",
            "487667                   Mike Tougias  2002   \n",
            "487668  Sybil GrÃ?Â¤fin SchÃ?Â¶nfeldt  1993   \n",
            "487669                   Joseph Cohen  1999   \n",
            "487670                 Eiji Yoshikawa  1995   \n",
            "\n",
            "                                   publisher  readScore  number_of_ratings  \n",
            "0                  John Wiley &amp; Sons Inc         25                 82  \n",
            "1                  John Wiley &amp; Sons Inc         25                 82  \n",
            "2                  John Wiley &amp; Sons Inc         25                 82  \n",
            "3                  John Wiley &amp; Sons Inc         25                 82  \n",
            "4                  John Wiley &amp; Sons Inc         25                 82  \n",
            "...                                      ...        ...                ...  \n",
            "487666                       Little Bookroom         50                  1  \n",
            "487667                    Capital Books (VA)         41                  1  \n",
            "487668  Bibliographisches Institut, Mannheim         83                  1  \n",
            "487669                              Konemann         38                  1  \n",
            "487670          Kodansha International (JPN)         23                  1  \n",
            "\n",
            "[487671 rows x 9 columns]\n"
          ]
        }
      ],
      "source": [
        "final_rating = rating_with_books.merge(number_rating, on='title')\n",
        "print(final_rating)\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "K__THQOhwvMD",
        "outputId": "a39ed716-6bac-486c-9df5-56c75d92ff5c"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "(22519, 9)\n"
          ]
        }
      ],
      "source": [
        "final_rating = final_rating[final_rating['number_of_ratings'] >=100]\n",
        "print(final_rating.shape)\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "wvf73PfUwvME",
        "outputId": "28e47dd2-bf3b-4f52-f98d-703ca849f7c6"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Index(['user_id', 'ISBN', 'rating', 'title', 'author', 'year', 'publisher',\n",
            "       'readScore', 'number_of_ratings'],\n",
            "      dtype='object')\n"
          ]
        }
      ],
      "source": [
        "final_rating.drop_duplicates(['user_id','title'], inplace=True)\n",
        "print(final_rating.columns)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "pbubQsDNwvME",
        "outputId": "e6ea0de6-96cf-4521-cb7b-8c3e71ff1d04"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "       user_id                     location   age  readScore_x        ISBN  \\\n",
            "0          254  minneapolis, minnesota, usa  24.0           24  0060930535   \n",
            "1          254  minneapolis, minnesota, usa  24.0           24  014100018X   \n",
            "2          254  minneapolis, minnesota, usa  24.0           24  0142001740   \n",
            "3          254  minneapolis, minnesota, usa  24.0           24  0316569321   \n",
            "4          254  minneapolis, minnesota, usa  24.0           24  0316776963   \n",
            "...        ...                          ...   ...          ...         ...   \n",
            "21606   278418         omaha, nebraska, usa   NaN           33  0451184963   \n",
            "21607   278418         omaha, nebraska, usa   NaN           33  0451186923   \n",
            "21608   278418         omaha, nebraska, usa   NaN           33  0515131229   \n",
            "21609   278418         omaha, nebraska, usa   NaN           33  0671617028   \n",
            "21610   278418         omaha, nebraska, usa   NaN           33  074343627X   \n",
            "\n",
            "       rating                                              title  \\\n",
            "0           0                      The Poisonwood Bible: A Novel   \n",
            "1           0                                           Chocolat   \n",
            "2           9                            The Secret Life of Bees   \n",
            "3           0                           White Oleander : A Novel   \n",
            "4           0                             Me Talk Pretty One Day   \n",
            "...       ...                                                ...   \n",
            "21606       0                                           Insomnia   \n",
            "21607       0                          The Deep End of the Ocean   \n",
            "21608       8  Dance upon the Air (Three Sisters Island Trilogy)   \n",
            "21609       0                                   The Color Purple   \n",
            "21610       0                                       Dreamcatcher   \n",
            "\n",
            "                   author  year         publisher  readScore_y  \\\n",
            "0      Barbara Kingsolver  1999         Perennial           82   \n",
            "1           Joanne Harris  2000     Penguin Books           46   \n",
            "2           Sue Monk Kidd  2003     Penguin Books            7   \n",
            "3             Janet Fitch  1999     Little, Brown           13   \n",
            "4           David Sedaris  2001    Back Bay Books           67   \n",
            "...                   ...   ...               ...          ...   \n",
            "21606        Stephen King  1995       Signet Book           40   \n",
            "21607  Jacquelyn Mitchard  1997  New Amer Library           19   \n",
            "21608        Nora Roberts  2003        Jove Books           32   \n",
            "21609        Alice Walker  1985      Pocket Books           39   \n",
            "21610        Stephen King  2001            Pocket            8   \n",
            "\n",
            "       number_of_ratings  \n",
            "0                    133  \n",
            "1                    103  \n",
            "2                    209  \n",
            "3                    116  \n",
            "4                    146  \n",
            "...                  ...  \n",
            "21606                105  \n",
            "21607                104  \n",
            "21608                100  \n",
            "21609                118  \n",
            "21610                161  \n",
            "\n",
            "[21611 rows x 12 columns]\n"
          ]
        }
      ],
      "source": [
        "s1=pd.merge(users,final_rating,how='inner',on=['user_id'])\n",
        "print(s1)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "it3pV6NRdA9K",
        "outputId": "81ea2977-4028-4be5-f47f-5038f367c213"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "(21611, 12)"
            ]
          },
          "execution_count": 20,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "s1.shape"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "dVWQkorDwvMF"
      },
      "outputs": [],
      "source": [
        "s2=pd.merge(s1,s1,how='inner',on=['readScore_x'])\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "owgQOZuDwvMG",
        "outputId": "1ff09bac-b1d2-430a-9d3e-1cbaac4a2d6f"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "         user_id_x                   location_x  age_x  readScore_x  \\\n",
            "0              254  minneapolis, minnesota, usa   24.0           24   \n",
            "1              254  minneapolis, minnesota, usa   24.0           24   \n",
            "2              254  minneapolis, minnesota, usa   24.0           24   \n",
            "3              254  minneapolis, minnesota, usa   24.0           24   \n",
            "4              254  minneapolis, minnesota, usa   24.0           24   \n",
            "...            ...                          ...    ...          ...   \n",
            "5494742     267635  bartlesville, oklahoma, usa   69.0           82   \n",
            "5494743     267635  bartlesville, oklahoma, usa   69.0           82   \n",
            "5494744     267635  bartlesville, oklahoma, usa   69.0           82   \n",
            "5494745     267635  bartlesville, oklahoma, usa   69.0           82   \n",
            "5494746     267635  bartlesville, oklahoma, usa   69.0           82   \n",
            "\n",
            "             ISBN_x  rating_x                        title_x  \\\n",
            "0        0060930535         0  The Poisonwood Bible: A Novel   \n",
            "1        0060930535         0  The Poisonwood Bible: A Novel   \n",
            "2        0060930535         0  The Poisonwood Bible: A Novel   \n",
            "3        0060930535         0  The Poisonwood Bible: A Novel   \n",
            "4        0060930535         0  The Poisonwood Bible: A Novel   \n",
            "...             ...       ...                            ...   \n",
            "5494742  0671027360         0            Angels &amp; Demons   \n",
            "5494743  0671027360         0            Angels &amp; Demons   \n",
            "5494744  0671027360         0            Angels &amp; Demons   \n",
            "5494745  0671027360         0            Angels &amp; Demons   \n",
            "5494746  0671027360         0            Angels &amp; Demons   \n",
            "\n",
            "                   author_x year_x  publisher_x  ...  \\\n",
            "0        Barbara Kingsolver   1999    Perennial  ...   \n",
            "1        Barbara Kingsolver   1999    Perennial  ...   \n",
            "2        Barbara Kingsolver   1999    Perennial  ...   \n",
            "3        Barbara Kingsolver   1999    Perennial  ...   \n",
            "4        Barbara Kingsolver   1999    Perennial  ...   \n",
            "...                     ...    ...          ...  ...   \n",
            "5494742           Dan Brown   2001  Pocket Star  ...   \n",
            "5494743           Dan Brown   2001  Pocket Star  ...   \n",
            "5494744           Dan Brown   2001  Pocket Star  ...   \n",
            "5494745           Dan Brown   2001  Pocket Star  ...   \n",
            "5494746           Dan Brown   2001  Pocket Star  ...   \n",
            "\n",
            "                          location_y  age_y      ISBN_y rating_y  \\\n",
            "0        minneapolis, minnesota, usa   24.0  0060930535        0   \n",
            "1        minneapolis, minnesota, usa   24.0  014100018X        0   \n",
            "2        minneapolis, minnesota, usa   24.0  0142001740        9   \n",
            "3        minneapolis, minnesota, usa   24.0  0316569321        0   \n",
            "4        minneapolis, minnesota, usa   24.0  0316776963        0   \n",
            "...                              ...    ...         ...      ...   \n",
            "5494742  bartlesville, oklahoma, usa   69.0  034541389X        0   \n",
            "5494743  bartlesville, oklahoma, usa   69.0  0345391055        8   \n",
            "5494744  bartlesville, oklahoma, usa   69.0  0446364193        8   \n",
            "5494745  bartlesville, oklahoma, usa   69.0  0345417623        9   \n",
            "5494746  bartlesville, oklahoma, usa   69.0  0671027360        0   \n",
            "\n",
            "                                         title_y            author_y  year_y  \\\n",
            "0                  The Poisonwood Bible: A Novel  Barbara Kingsolver    1999   \n",
            "1                                       Chocolat       Joanne Harris    2000   \n",
            "2                        The Secret Life of Bees       Sue Monk Kidd    2003   \n",
            "3                       White Oleander : A Novel         Janet Fitch    1999   \n",
            "4                         Me Talk Pretty One Day       David Sedaris    2001   \n",
            "...                                          ...                 ...     ...   \n",
            "5494742                          Flesh and Blood  Jonathan Kellerman    2002   \n",
            "5494743                               Disclosure    Michael Crichton    1994   \n",
            "5494744  Along Came a Spider (Alex Cross Novels)     James Patterson    1993   \n",
            "5494745                                 Timeline    MICHAEL CRICHTON    2000   \n",
            "5494746                      Angels &amp; Demons           Dan Brown    2001   \n",
            "\n",
            "              publisher_y readScore_y_y number_of_ratings_y  \n",
            "0               Perennial            82                 133  \n",
            "1           Penguin Books            46                 103  \n",
            "2           Penguin Books             7                 209  \n",
            "3           Little, Brown            13                 116  \n",
            "4          Back Bay Books            67                 146  \n",
            "...                   ...           ...                 ...  \n",
            "5494742  Ballantine Books            72                 103  \n",
            "5494743  Ballantine Books            62                 122  \n",
            "5494744      Warner Books            36                 134  \n",
            "5494745  Ballantine Books            78                 145  \n",
            "5494746       Pocket Star            92                 193  \n",
            "\n",
            "[5494747 rows x 23 columns]\n"
          ]
        }
      ],
      "source": [
        "print(s2)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "ZHVOEUvzwvMG",
        "outputId": "1eec65ce-68a2-4c87-8485-ff78b4266b29"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "user_id_x  254     2276    2766    2977    3363    3757    4017    4385    \\\n",
            "user_id_y                                                                   \n",
            "254          24.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0   \n",
            "2276          0.0    45.0     0.0     0.0     0.0     0.0     0.0     0.0   \n",
            "2766          0.0     0.0    46.0     0.0     0.0     0.0     0.0     0.0   \n",
            "2977          0.0     0.0     0.0     6.0     0.0     0.0     0.0     0.0   \n",
            "3363          0.0     0.0     0.0     0.0    61.0     0.0     0.0     0.0   \n",
            "...           ...     ...     ...     ...     ...     ...     ...     ...   \n",
            "275970        0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0   \n",
            "277427        0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0   \n",
            "277478        0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0   \n",
            "277639        0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0   \n",
            "278418        0.0     0.0     0.0     0.0     0.0     0.0     0.0     0.0   \n",
            "\n",
            "user_id_x  6242    6251    ...  274004  274061  274301  274308  274808  \\\n",
            "user_id_y                  ...                                           \n",
            "254           0.0     0.0  ...     0.0     0.0     0.0     0.0     0.0   \n",
            "2276          0.0     0.0  ...     0.0     0.0     0.0     0.0     0.0   \n",
            "2766          0.0     0.0  ...     0.0     0.0     0.0     0.0     0.0   \n",
            "2977          0.0     0.0  ...     0.0     0.0     0.0     0.0     0.0   \n",
            "3363          0.0     0.0  ...     0.0     0.0     0.0     0.0     0.0   \n",
            "...           ...     ...  ...     ...     ...     ...     ...     ...   \n",
            "275970        0.0     0.0  ...     0.0     0.0     0.0     0.0     0.0   \n",
            "277427        0.0     0.0  ...     0.0     0.0     0.0     0.0     0.0   \n",
            "277478        0.0     0.0  ...     0.0     0.0     0.0     0.0     0.0   \n",
            "277639        0.0     0.0  ...     0.0     0.0     0.0     0.0     0.0   \n",
            "278418        0.0     0.0  ...     0.0     0.0     0.0     0.0     0.0   \n",
            "\n",
            "user_id_x  275970  277427  277478  277639  278418  \n",
            "user_id_y                                          \n",
            "254           0.0     0.0     0.0     0.0     0.0  \n",
            "2276          0.0     0.0     0.0     0.0     0.0  \n",
            "2766          0.0     0.0     0.0     0.0     0.0  \n",
            "2977          0.0     0.0     0.0     0.0     0.0  \n",
            "3363          0.0     0.0     0.0     0.0     0.0  \n",
            "...           ...     ...     ...     ...     ...  \n",
            "275970       68.0     0.0     0.0     0.0     0.0  \n",
            "277427        0.0    70.0     0.0     0.0     0.0  \n",
            "277478        0.0     0.0    57.0     0.0     0.0  \n",
            "277639        0.0     0.0     0.0    78.0     0.0  \n",
            "278418        0.0     0.0     0.0     0.0    33.0  \n",
            "\n",
            "[876 rows x 876 columns]\n"
          ]
        }
      ],
      "source": [
        "user_pivot=s2.pivot_table(columns='user_id_x',index='user_id_y',values='readScore_x')\n",
        "#print(user_pivot)\n",
        "user_pivot.fillna(0, inplace=True)\n",
        "print(user_pivot)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "1rNHpqyTwvMG"
      },
      "outputs": [],
      "source": [
        "s3=pd.merge(s1,s1,how='inner',on=['readScore_y'])"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "wgD-kf-6wvMH",
        "outputId": "9d6a94b2-03e7-45d2-818c-a5d8fc62a94b"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "         user_id_x                   location_x  age_x  readScore_x_x  \\\n",
            "0              254  minneapolis, minnesota, usa   24.0             24   \n",
            "1              254  minneapolis, minnesota, usa   24.0             24   \n",
            "2              254  minneapolis, minnesota, usa   24.0             24   \n",
            "3              254  minneapolis, minnesota, usa   24.0             24   \n",
            "4              254  minneapolis, minnesota, usa   24.0             24   \n",
            "...            ...                          ...    ...            ...   \n",
            "7308802     219546     new albany, indiana, usa   25.0             46   \n",
            "7308803     255218     anaheim, california, usa   46.0             39   \n",
            "7308804     255218     anaheim, california, usa   46.0             39   \n",
            "7308805     255218     anaheim, california, usa   46.0             39   \n",
            "7308806     224349      columbia, maryland, usa   23.0             58   \n",
            "\n",
            "             ISBN_x  rating_x                        title_x  \\\n",
            "0        0060930535         0  The Poisonwood Bible: A Novel   \n",
            "1        0060930535         0  The Poisonwood Bible: A Novel   \n",
            "2        0060930535         0  The Poisonwood Bible: A Novel   \n",
            "3        0060930535         0  The Poisonwood Bible: A Novel   \n",
            "4        0060930535         0  The Poisonwood Bible: A Novel   \n",
            "...             ...       ...                            ...   \n",
            "7308802  0679781307         0                     The Reader   \n",
            "7308803  0679781307         0                     The Reader   \n",
            "7308804  0679781307         0                     The Reader   \n",
            "7308805  0679781307         0                     The Reader   \n",
            "7308806  0553525654         0                      Tara Road   \n",
            "\n",
            "                    author_x year_x       publisher_x  ...  \\\n",
            "0         Barbara Kingsolver   1999         Perennial  ...   \n",
            "1         Barbara Kingsolver   1999         Perennial  ...   \n",
            "2         Barbara Kingsolver   1999         Perennial  ...   \n",
            "3         Barbara Kingsolver   1999         Perennial  ...   \n",
            "4         Barbara Kingsolver   1999         Perennial  ...   \n",
            "...                      ...    ...               ...  ...   \n",
            "7308802  Carol Brown Janeway   1998  Random House Inc  ...   \n",
            "7308803  Carol Brown Janeway   1998  Random House Inc  ...   \n",
            "7308804  Carol Brown Janeway   1998  Random House Inc  ...   \n",
            "7308805  Carol Brown Janeway   1998  Random House Inc  ...   \n",
            "7308806         Maeve Binchy   1999      Random House  ...   \n",
            "\n",
            "                          location_y  age_y  readScore_x_y      ISBN_y  \\\n",
            "0        minneapolis, minnesota, usa   24.0             24  0060930535   \n",
            "1          richland, washington, usa   25.0              6  0440234743   \n",
            "2          knoxville, tennessee, usa   29.0             61  0440234743   \n",
            "3               wahiawa, hawaii, usa   32.0             50  0060930535   \n",
            "4         sunnyvale, california, usa   49.0             56  0060930535   \n",
            "...                              ...    ...            ...         ...   \n",
            "7308802     anaheim, california, usa   46.0             39  0679781307   \n",
            "7308803       fort worth, texas, usa   25.0             26  0679781307   \n",
            "7308804     new albany, indiana, usa   25.0             46  0679781307   \n",
            "7308805     anaheim, california, usa   46.0             39  0679781307   \n",
            "7308806      columbia, maryland, usa   23.0             58  0553525654   \n",
            "\n",
            "         rating_y                        title_y             author_y  year_y  \\\n",
            "0               0  The Poisonwood Bible: A Novel   Barbara Kingsolver    1999   \n",
            "1               0                  The Testament         John Grisham    1999   \n",
            "2               0                  The Testament         John Grisham    1999   \n",
            "3               0  The Poisonwood Bible: A Novel   Barbara Kingsolver    1999   \n",
            "4               0  The Poisonwood Bible: A Novel   Barbara Kingsolver    1999   \n",
            "...           ...                            ...                  ...     ...   \n",
            "7308802         0                     The Reader  Carol Brown Janeway    1998   \n",
            "7308803         0                     The Reader  Carol Brown Janeway    1998   \n",
            "7308804         0                     The Reader  Carol Brown Janeway    1998   \n",
            "7308805         0                     The Reader  Carol Brown Janeway    1998   \n",
            "7308806         0                      Tara Road         Maeve Binchy    1999   \n",
            "\n",
            "              publisher_y number_of_ratings_y  \n",
            "0               Perennial                 133  \n",
            "1                    Dell                 182  \n",
            "2                    Dell                 182  \n",
            "3               Perennial                 133  \n",
            "4               Perennial                 133  \n",
            "...                   ...                 ...  \n",
            "7308802  Random House Inc                 140  \n",
            "7308803  Random House Inc                 140  \n",
            "7308804  Random House Inc                 140  \n",
            "7308805  Random House Inc                 140  \n",
            "7308806      Random House                 112  \n",
            "\n",
            "[7308807 rows x 23 columns]\n"
          ]
        }
      ],
      "source": [
        "print(s3)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "LKvdDJZ7wvMH",
        "outputId": "9b3e6abc-4133-4090-eb29-acbc26fa55ec"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "title_x                                             1st to Die: A Novel  \\\n",
            "title_y                                                                   \n",
            "1st to Die: A Novel                                           74.431181   \n",
            "2nd Chance                                                     0.000000   \n",
            "A Bend in the Road                                             0.000000   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...             0.000000   \n",
            "A Map of the World                                             0.000000   \n",
            "...                                                                 ...   \n",
            "White Oleander : A Novel                                       0.000000   \n",
            "White Oleander : A Novel (Oprah's Book Club)                   0.000000   \n",
            "Wicked: The Life and Times of the Wicked Witch ...             0.000000   \n",
            "Wild Animus                                                    0.000000   \n",
            "\\O\\\" Is for Outlaw\"                                            0.000000   \n",
            "\n",
            "title_x                                             2nd Chance  \\\n",
            "title_y                                                          \n",
            "1st to Die: A Novel                                    0.00000   \n",
            "2nd Chance                                             6.34372   \n",
            "A Bend in the Road                                     0.00000   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...     0.00000   \n",
            "A Map of the World                                     0.00000   \n",
            "...                                                        ...   \n",
            "White Oleander : A Novel                               0.00000   \n",
            "White Oleander : A Novel (Oprah's Book Club)           0.00000   \n",
            "Wicked: The Life and Times of the Wicked Witch ...     3.00000   \n",
            "Wild Animus                                            0.00000   \n",
            "\\O\\\" Is for Outlaw\"                                    0.00000   \n",
            "\n",
            "title_x                                             A Bend in the Road  \\\n",
            "title_y                                                                  \n",
            "1st to Die: A Novel                                            0.00000   \n",
            "2nd Chance                                                     0.00000   \n",
            "A Bend in the Road                                            86.01454   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...             0.00000   \n",
            "A Map of the World                                             0.00000   \n",
            "...                                                                ...   \n",
            "White Oleander : A Novel                                       0.00000   \n",
            "White Oleander : A Novel (Oprah's Book Club)                   0.00000   \n",
            "Wicked: The Life and Times of the Wicked Witch ...             0.00000   \n",
            "Wild Animus                                                    0.00000   \n",
            "\\O\\\" Is for Outlaw\"                                            0.00000   \n",
            "\n",
            "title_x                                             A Is for Alibi (Kinsey Millhone Mysteries (Paperback))  \\\n",
            "title_y                                                                                                      \n",
            "1st to Die: A Novel                                                                               0.0        \n",
            "2nd Chance                                                                                        0.0        \n",
            "A Bend in the Road                                                                                0.0        \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...                                               88.0        \n",
            "A Map of the World                                                                                0.0        \n",
            "...                                                                                               ...        \n",
            "White Oleander : A Novel                                                                          0.0        \n",
            "White Oleander : A Novel (Oprah's Book Club)                                                      0.0        \n",
            "Wicked: The Life and Times of the Wicked Witch ...                                                0.0        \n",
            "Wild Animus                                                                                       0.0        \n",
            "\\O\\\" Is for Outlaw\"                                                                               0.0        \n",
            "\n",
            "title_x                                             A Map of the World  \\\n",
            "title_y                                                                  \n",
            "1st to Die: A Novel                                           0.000000   \n",
            "2nd Chance                                                    0.000000   \n",
            "A Bend in the Road                                            0.000000   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...            0.000000   \n",
            "A Map of the World                                           64.997151   \n",
            "...                                                                ...   \n",
            "White Oleander : A Novel                                      0.000000   \n",
            "White Oleander : A Novel (Oprah's Book Club)                  0.000000   \n",
            "Wicked: The Life and Times of the Wicked Witch ...            0.000000   \n",
            "Wild Animus                                                   0.000000   \n",
            "\\O\\\" Is for Outlaw\"                                           0.000000   \n",
            "\n",
            "title_x                                             A Painted House  \\\n",
            "title_y                                                               \n",
            "1st to Die: A Novel                                             0.0   \n",
            "2nd Chance                                                      0.0   \n",
            "A Bend in the Road                                              0.0   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...              0.0   \n",
            "A Map of the World                                              0.0   \n",
            "...                                                             ...   \n",
            "White Oleander : A Novel                                        0.0   \n",
            "White Oleander : A Novel (Oprah's Book Club)                    0.0   \n",
            "Wicked: The Life and Times of the Wicked Witch ...              0.0   \n",
            "Wild Animus                                                     0.0   \n",
            "\\O\\\" Is for Outlaw\"                                             0.0   \n",
            "\n",
            "title_x                                             A Prayer for Owen Meany  \\\n",
            "title_y                                                                       \n",
            "1st to Die: A Novel                                                     0.0   \n",
            "2nd Chance                                                              0.0   \n",
            "A Bend in the Road                                                      0.0   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...                      0.0   \n",
            "A Map of the World                                                      0.0   \n",
            "...                                                                     ...   \n",
            "White Oleander : A Novel                                                0.0   \n",
            "White Oleander : A Novel (Oprah's Book Club)                            0.0   \n",
            "Wicked: The Life and Times of the Wicked Witch ...                      0.0   \n",
            "Wild Animus                                                             0.0   \n",
            "\\O\\\" Is for Outlaw\"                                                     0.0   \n",
            "\n",
            "title_x                                             A Time to Kill  \\\n",
            "title_y                                                              \n",
            "1st to Die: A Novel                                            0.0   \n",
            "2nd Chance                                                     0.0   \n",
            "A Bend in the Road                                             0.0   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...             0.0   \n",
            "A Map of the World                                             0.0   \n",
            "...                                                            ...   \n",
            "White Oleander : A Novel                                       0.0   \n",
            "White Oleander : A Novel (Oprah's Book Club)                   0.0   \n",
            "Wicked: The Life and Times of the Wicked Witch ...             0.0   \n",
            "Wild Animus                                                    0.0   \n",
            "\\O\\\" Is for Outlaw\"                                            0.0   \n",
            "\n",
            "title_x                                             A Walk to Remember  \\\n",
            "title_y                                                                  \n",
            "1st to Die: A Novel                                                0.0   \n",
            "2nd Chance                                                        22.0   \n",
            "A Bend in the Road                                                 0.0   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...                 0.0   \n",
            "A Map of the World                                                 0.0   \n",
            "...                                                                ...   \n",
            "White Oleander : A Novel                                           0.0   \n",
            "White Oleander : A Novel (Oprah's Book Club)                       0.0   \n",
            "Wicked: The Life and Times of the Wicked Witch ...                 0.0   \n",
            "Wild Animus                                                        0.0   \n",
            "\\O\\\" Is for Outlaw\"                                                0.0   \n",
            "\n",
            "title_x                                             Airframe  ...  \\\n",
            "title_y                                                       ...   \n",
            "1st to Die: A Novel                                      0.0  ...   \n",
            "2nd Chance                                              59.0  ...   \n",
            "A Bend in the Road                                       0.0  ...   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...       0.0  ...   \n",
            "A Map of the World                                      80.0  ...   \n",
            "...                                                      ...  ...   \n",
            "White Oleander : A Novel                                 0.0  ...   \n",
            "White Oleander : A Novel (Oprah's Book Club)             0.0  ...   \n",
            "Wicked: The Life and Times of the Wicked Witch ...       0.0  ...   \n",
            "Wild Animus                                              0.0  ...   \n",
            "\\O\\\" Is for Outlaw\"                                      0.0  ...   \n",
            "\n",
            "title_x                                             We Were the Mulvaneys  \\\n",
            "title_y                                                                     \n",
            "1st to Die: A Novel                                                   0.0   \n",
            "2nd Chance                                                            0.0   \n",
            "A Bend in the Road                                                    0.0   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...                    0.0   \n",
            "A Map of the World                                                    0.0   \n",
            "...                                                                   ...   \n",
            "White Oleander : A Novel                                              0.0   \n",
            "White Oleander : A Novel (Oprah's Book Club)                          0.0   \n",
            "Wicked: The Life and Times of the Wicked Witch ...                    0.0   \n",
            "Wild Animus                                                           0.0   \n",
            "\\O\\\" Is for Outlaw\"                                                   0.0   \n",
            "\n",
            "title_x                                             When the Wind Blows  \\\n",
            "title_y                                                                   \n",
            "1st to Die: A Novel                                                 0.0   \n",
            "2nd Chance                                                         59.0   \n",
            "A Bend in the Road                                                  0.0   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...                  0.0   \n",
            "A Map of the World                                                  0.0   \n",
            "...                                                                 ...   \n",
            "White Oleander : A Novel                                            0.0   \n",
            "White Oleander : A Novel (Oprah's Book Club)                        0.0   \n",
            "Wicked: The Life and Times of the Wicked Witch ...                  0.0   \n",
            "Wild Animus                                                         0.0   \n",
            "\\O\\\" Is for Outlaw\"                                                 0.0   \n",
            "\n",
            "title_x                                             Where the Heart Is (Oprah's Book Club (Paperback))  \\\n",
            "title_y                                                                                                  \n",
            "1st to Die: A Novel                                                                               0.0    \n",
            "2nd Chance                                                                                        0.0    \n",
            "A Bend in the Road                                                                                0.0    \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...                                                0.0    \n",
            "A Map of the World                                                                                0.0    \n",
            "...                                                                                               ...    \n",
            "White Oleander : A Novel                                                                          0.0    \n",
            "White Oleander : A Novel (Oprah's Book Club)                                                      0.0    \n",
            "Wicked: The Life and Times of the Wicked Witch ...                                                0.0    \n",
            "Wild Animus                                                                                       0.0    \n",
            "\\O\\\" Is for Outlaw\"                                                                               0.0    \n",
            "\n",
            "title_x                                             While I Was Gone  \\\n",
            "title_y                                                                \n",
            "1st to Die: A Novel                                              0.0   \n",
            "2nd Chance                                                       0.0   \n",
            "A Bend in the Road                                               0.0   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...               0.0   \n",
            "A Map of the World                                               0.0   \n",
            "...                                                              ...   \n",
            "White Oleander : A Novel                                         0.0   \n",
            "White Oleander : A Novel (Oprah's Book Club)                     0.0   \n",
            "Wicked: The Life and Times of the Wicked Witch ...               0.0   \n",
            "Wild Animus                                                      0.0   \n",
            "\\O\\\" Is for Outlaw\"                                             33.0   \n",
            "\n",
            "title_x                                             Whispers  \\\n",
            "title_y                                                        \n",
            "1st to Die: A Novel                                      0.0   \n",
            "2nd Chance                                               0.0   \n",
            "A Bend in the Road                                       0.0   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...       0.0   \n",
            "A Map of the World                                       0.0   \n",
            "...                                                      ...   \n",
            "White Oleander : A Novel                                 0.0   \n",
            "White Oleander : A Novel (Oprah's Book Club)             0.0   \n",
            "Wicked: The Life and Times of the Wicked Witch ...       0.0   \n",
            "Wild Animus                                              0.0   \n",
            "\\O\\\" Is for Outlaw\"                                      0.0   \n",
            "\n",
            "title_x                                             White Oleander : A Novel  \\\n",
            "title_y                                                                        \n",
            "1st to Die: A Novel                                                 0.000000   \n",
            "2nd Chance                                                          0.000000   \n",
            "A Bend in the Road                                                  0.000000   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...                  0.000000   \n",
            "A Map of the World                                                  0.000000   \n",
            "...                                                                      ...   \n",
            "White Oleander : A Novel                                           16.527172   \n",
            "White Oleander : A Novel (Oprah's Book Club)                        0.000000   \n",
            "Wicked: The Life and Times of the Wicked Witch ...                  0.000000   \n",
            "Wild Animus                                                         0.000000   \n",
            "\\O\\\" Is for Outlaw\"                                                 0.000000   \n",
            "\n",
            "title_x                                             White Oleander : A Novel (Oprah's Book Club)  \\\n",
            "title_y                                                                                            \n",
            "1st to Die: A Novel                                                                          0.0   \n",
            "2nd Chance                                                                                   0.0   \n",
            "A Bend in the Road                                                                           0.0   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...                                           0.0   \n",
            "A Map of the World                                                                           0.0   \n",
            "...                                                                                          ...   \n",
            "White Oleander : A Novel                                                                     0.0   \n",
            "White Oleander : A Novel (Oprah's Book Club)                                                12.0   \n",
            "Wicked: The Life and Times of the Wicked Witch ...                                           0.0   \n",
            "Wild Animus                                                                                  0.0   \n",
            "\\O\\\" Is for Outlaw\"                                                                          0.0   \n",
            "\n",
            "title_x                                             Wicked: The Life and Times of the Wicked Witch of the West  \\\n",
            "title_y                                                                                                          \n",
            "1st to Die: A Novel                                                                               0.0            \n",
            "2nd Chance                                                                                        3.0            \n",
            "A Bend in the Road                                                                                0.0            \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...                                                0.0            \n",
            "A Map of the World                                                                                0.0            \n",
            "...                                                                                               ...            \n",
            "White Oleander : A Novel                                                                          0.0            \n",
            "White Oleander : A Novel (Oprah's Book Club)                                                      0.0            \n",
            "Wicked: The Life and Times of the Wicked Witch ...                                                3.0            \n",
            "Wild Animus                                                                                       0.0            \n",
            "\\O\\\" Is for Outlaw\"                                                                               0.0            \n",
            "\n",
            "title_x                                             Wild Animus  \\\n",
            "title_y                                                           \n",
            "1st to Die: A Novel                                         0.0   \n",
            "2nd Chance                                                  0.0   \n",
            "A Bend in the Road                                          0.0   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...          0.0   \n",
            "A Map of the World                                          0.0   \n",
            "...                                                         ...   \n",
            "White Oleander : A Novel                                    0.0   \n",
            "White Oleander : A Novel (Oprah's Book Club)                0.0   \n",
            "Wicked: The Life and Times of the Wicked Witch ...          0.0   \n",
            "Wild Animus                                                40.0   \n",
            "\\O\\\" Is for Outlaw\"                                         0.0   \n",
            "\n",
            "title_x                                             \\O\\\" Is for Outlaw\"  \n",
            "title_y                                                                  \n",
            "1st to Die: A Novel                                            0.000000  \n",
            "2nd Chance                                                     0.000000  \n",
            "A Bend in the Road                                             0.000000  \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...             0.000000  \n",
            "A Map of the World                                             0.000000  \n",
            "...                                                                 ...  \n",
            "White Oleander : A Novel                                       0.000000  \n",
            "White Oleander : A Novel (Oprah's Book Club)                   0.000000  \n",
            "Wicked: The Life and Times of the Wicked Witch ...             0.000000  \n",
            "Wild Animus                                                    0.000000  \n",
            "\\O\\\" Is for Outlaw\"                                           72.808874  \n",
            "\n",
            "[158 rows x 158 columns]\n"
          ]
        }
      ],
      "source": [
        "usbook_pivot=s3.pivot_table(columns='title_x',index='title_y',values='readScore_y')\n",
        "#print(usbook_pivot)\n",
        "usbook_pivot.fillna(0, inplace=True)\n",
        "print(usbook_pivot)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "A8nnWzwJaYMG",
        "outputId": "3c114805-116a-497f-ed66-446efe5e42f3"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "user_id                                             254     2276    2766    \\\n",
            "title                                                                        \n",
            "1st to Die: A Novel                                    0.0     0.0     0.0   \n",
            "2nd Chance                                             0.0    10.0     0.0   \n",
            "A Bend in the Road                                     0.0     0.0     7.0   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...     0.0     0.0     7.0   \n",
            "A Map of the World                                     0.0     0.0     0.0   \n",
            "...                                                    ...     ...     ...   \n",
            "White Oleander : A Novel                               0.0     0.0     0.0   \n",
            "White Oleander : A Novel (Oprah's Book Club)           0.0     0.0     0.0   \n",
            "Wicked: The Life and Times of the Wicked Witch ...     0.0     0.0     0.0   \n",
            "Wild Animus                                            0.0     0.0     6.0   \n",
            "\\O\\\" Is for Outlaw\"                                    0.0     0.0     0.0   \n",
            "\n",
            "user_id                                             2977    3363    3757    \\\n",
            "title                                                                        \n",
            "1st to Die: A Novel                                    0.0     0.0     0.0   \n",
            "2nd Chance                                             0.0     0.0     0.0   \n",
            "A Bend in the Road                                     0.0     0.0     0.0   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...     0.0     0.0     0.0   \n",
            "A Map of the World                                     0.0     0.0     0.0   \n",
            "...                                                    ...     ...     ...   \n",
            "White Oleander : A Novel                               7.0     0.0     0.0   \n",
            "White Oleander : A Novel (Oprah's Book Club)           0.0     0.0     0.0   \n",
            "Wicked: The Life and Times of the Wicked Witch ...     0.0     0.0     0.0   \n",
            "Wild Animus                                            0.0     0.0     0.0   \n",
            "\\O\\\" Is for Outlaw\"                                    0.0     0.0     0.0   \n",
            "\n",
            "user_id                                             4017    4385    6242    \\\n",
            "title                                                                        \n",
            "1st to Die: A Novel                                    0.0     0.0     0.0   \n",
            "2nd Chance                                             0.0     0.0     0.0   \n",
            "A Bend in the Road                                     0.0     0.0     0.0   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...     0.0     0.0     0.0   \n",
            "A Map of the World                                     0.0     0.0     0.0   \n",
            "...                                                    ...     ...     ...   \n",
            "White Oleander : A Novel                               0.0     0.0     0.0   \n",
            "White Oleander : A Novel (Oprah's Book Club)           0.0     0.0     0.0   \n",
            "Wicked: The Life and Times of the Wicked Witch ...     0.0     0.0     7.0   \n",
            "Wild Animus                                            0.0     0.0     0.0   \n",
            "\\O\\\" Is for Outlaw\"                                    0.0     0.0     0.0   \n",
            "\n",
            "user_id                                             6251    ...  274004  \\\n",
            "title                                                       ...           \n",
            "1st to Die: A Novel                                    0.0  ...     0.0   \n",
            "2nd Chance                                             0.0  ...     0.0   \n",
            "A Bend in the Road                                     0.0  ...     0.0   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...     0.0  ...     0.0   \n",
            "A Map of the World                                     0.0  ...     0.0   \n",
            "...                                                    ...  ...     ...   \n",
            "White Oleander : A Novel                               8.0  ...     0.0   \n",
            "White Oleander : A Novel (Oprah's Book Club)           0.0  ...     0.0   \n",
            "Wicked: The Life and Times of the Wicked Witch ...     0.0  ...     0.0   \n",
            "Wild Animus                                            0.0  ...     0.0   \n",
            "\\O\\\" Is for Outlaw\"                                    0.0  ...     0.0   \n",
            "\n",
            "user_id                                             274061  274301  274308  \\\n",
            "title                                                                        \n",
            "1st to Die: A Novel                                    0.0     0.0     0.0   \n",
            "2nd Chance                                             0.0     0.0     0.0   \n",
            "A Bend in the Road                                     0.0     0.0     0.0   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...     0.0    10.0     0.0   \n",
            "A Map of the World                                     0.0     0.0     0.0   \n",
            "...                                                    ...     ...     ...   \n",
            "White Oleander : A Novel                               0.0     0.0     0.0   \n",
            "White Oleander : A Novel (Oprah's Book Club)           0.0     0.0     0.0   \n",
            "Wicked: The Life and Times of the Wicked Witch ...     0.0     0.0     0.0   \n",
            "Wild Animus                                            0.0     0.0     0.0   \n",
            "\\O\\\" Is for Outlaw\"                                    0.0     8.0     0.0   \n",
            "\n",
            "user_id                                             274808  275970  277427  \\\n",
            "title                                                                        \n",
            "1st to Die: A Novel                                    0.0     0.0     0.0   \n",
            "2nd Chance                                             0.0     0.0     0.0   \n",
            "A Bend in the Road                                     0.0     0.0     0.0   \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...     0.0     0.0     0.0   \n",
            "A Map of the World                                     0.0     0.0     0.0   \n",
            "...                                                    ...     ...     ...   \n",
            "White Oleander : A Novel                               0.0     0.0     0.0   \n",
            "White Oleander : A Novel (Oprah's Book Club)           0.0     0.0     0.0   \n",
            "Wicked: The Life and Times of the Wicked Witch ...     0.0     0.0     0.0   \n",
            "Wild Animus                                            0.0     0.0     0.0   \n",
            "\\O\\\" Is for Outlaw\"                                    0.0     0.0     0.0   \n",
            "\n",
            "user_id                                             277478  277639  278418  \n",
            "title                                                                       \n",
            "1st to Die: A Novel                                    0.0     0.0     0.0  \n",
            "2nd Chance                                             0.0     0.0     0.0  \n",
            "A Bend in the Road                                     0.0     0.0     0.0  \n",
            "A Is for Alibi (Kinsey Millhone Mysteries (Pape...     0.0     0.0     0.0  \n",
            "A Map of the World                                     0.0     0.0     0.0  \n",
            "...                                                    ...     ...     ...  \n",
            "White Oleander : A Novel                               0.0     0.0     0.0  \n",
            "White Oleander : A Novel (Oprah's Book Club)           0.0     0.0     0.0  \n",
            "Wicked: The Life and Times of the Wicked Witch ...     0.0     0.0     0.0  \n",
            "Wild Animus                                            0.0     0.0     0.0  \n",
            "\\O\\\" Is for Outlaw\"                                    0.0     0.0     0.0  \n",
            "\n",
            "[158 rows x 876 columns]\n"
          ]
        }
      ],
      "source": [
        "book_pivot = s1.pivot_table(columns='user_id', index='title', values=\"rating\")\n",
        "#print(book_pivot)\n",
        "book_pivot.fillna(0, inplace=True)\n",
        "print(book_pivot)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "zqZ6hUBEab4O"
      },
      "outputs": [],
      "source": [
        "from scipy.sparse import csr_matrix\n",
        "book_sparse = csr_matrix(book_pivot)\n",
        "user_sparse=csr_matrix(user_pivot)\n",
        "usbook_sparse=csr_matrix(usbook_pivot)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "1VeD1u_QafHv",
        "outputId": "4749660a-0179-4ddf-85b3-d4aec6576be2"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "NearestNeighbors(algorithm='brute')"
            ]
          },
          "execution_count": 29,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "from sklearn.neighbors import NearestNeighbors\n",
        "model = NearestNeighbors(algorithm='brute')\n",
        "model.fit(book_sparse)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "4PyBdBi0ambf",
        "outputId": "5def895b-04b2-404d-cb89-a1da7ae709bd"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "[[ 0.         64.92303135 65.13831438 65.36053855 65.39877675]]\n",
            "[[ 12  70 101 152  74]]\n"
          ]
        }
      ],
      "source": [
        "#z=book_pivot.iloc[237, :].values.reshape(1,-1)\n",
        "#print(z)\n",
        "distances, suggestions = model.kneighbors(book_pivot.iloc[12, :].values.reshape(1, -1))\n",
        "print(distances)\n",
        "print(suggestions)\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "9pVzDCtFaqj_",
        "outputId": "2f6c9ea8-be89-48a6-81ca-4dea78bdcf55"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Index(['Angels &amp; Demons', 'Pop Goes the Weasel',\n",
            "       'The Deep End of the Ocean', 'Whispers', 'Rising Sun'],\n",
            "      dtype='object', name='title')\n"
          ]
        }
      ],
      "source": [
        "for i in range(len(suggestions)):\n",
        "  print(book_pivot.index[suggestions[i]])"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "5YUXzL9zwvMJ",
        "outputId": "6fe291fd-15be-4fbe-eef8-a62d73769871"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "NearestNeighbors(algorithm='brute')"
            ]
          },
          "execution_count": 32,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "from sklearn.neighbors import NearestNeighbors\n",
        "model = NearestNeighbors(algorithm='brute')\n",
        "model.fit(user_sparse)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "EzzP2_r3wvMJ",
        "outputId": "ee709b9e-9335-40cb-e825-f0b42c7d14e2"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "[[0. 0. 0. 0. 0.]]\n",
            "[[663 492 771 244 377]]\n"
          ]
        }
      ],
      "source": [
        "distances, suggestions = model.kneighbors(user_pivot.iloc[12, :].values.reshape(1, -1))\n",
        "print(distances)\n",
        "print(suggestions)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "o2xjDyR4wvMJ",
        "outputId": "8de6fe4b-f85b-4dcd-960c-c09139f0f85a"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "[\"The Kitchen God's Wife\", 'The Client', \"The Kitchen God's Wife\", 'The Perfect Storm : A True Story of Men Against the Sea', 'The Rainmaker']\n"
          ]
        }
      ],
      "source": [
        "for i in range(len(suggestions)):\n",
        "    reco=user_pivot.index[suggestions[i]]\n",
        "a=[]\n",
        "for i in reco:\n",
        "    a.append(pd.unique(s1['title'][s1['user_id']==i]))\n",
        "b=[]\n",
        "for i in range(len(a)-1):\n",
        "    b.extend(np.intersect1d(a[i],a[i+1]))\n",
        "\n",
        "print(b[:5])\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "isKLHUKswvMK",
        "outputId": "77a6227d-3ceb-4fb7-c901-28bb2dceadb0"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "NearestNeighbors(algorithm='brute')"
            ]
          },
          "execution_count": 35,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "from sklearn.neighbors import NearestNeighbors\n",
        "model = NearestNeighbors(algorithm='brute')\n",
        "model.fit(usbook_sparse)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "ZLPD3fYTwvMK",
        "outputId": "274a7b3f-67ad-4a49-84aa-a0096da21db1"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "[[  0.         296.49741708 309.737368   320.82427743 331.01471943]]\n",
            "[[ 12   7 133  20 130]]\n"
          ]
        }
      ],
      "source": [
        "distances, suggestions = model.kneighbors(usbook_pivot.iloc[12, :].values.reshape(1, -1))\n",
        "print(distances)\n",
        "print(suggestions)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "D0m4srvbwvMK",
        "outputId": "1248c6ce-2582-453e-fc69-8d6bba7a7751"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Index(['Angels &amp; Demons', 'A Time to Kill', 'The Secret Life of Bees',\n",
            "       'Bridget Jones's Diary', 'The Red Tent (Bestselling Backlist)'],\n",
            "      dtype='object', name='title_y')\n"
          ]
        }
      ],
      "source": [
        "for i in range(len(suggestions)):\n",
        "  print(usbook_pivot.index[suggestions[i]])"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "WN-7ZwnswvMK"
      },
      "outputs": [],
      "source": [
        "reader = Reader(rating_scale=(0, 9))\n",
        "data = Dataset.load_from_df(s1[['user_id','title','rating']], reader)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "pzAhYHd4wvML",
        "outputId": "1304b5ca-3252-4c05-ec43-e5ccfbf6b6fc"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Estimating biases using als...\n",
            "Computing the msd similarity matrix...\n",
            "Done computing similarity matrix.\n",
            "Estimating biases using als...\n",
            "Computing the msd similarity matrix...\n",
            "Done computing similarity matrix.\n",
            "Estimating biases using als...\n",
            "Computing the msd similarity matrix...\n",
            "Done computing similarity matrix.\n",
            "Computing the msd similarity matrix...\n",
            "Done computing similarity matrix.\n",
            "Computing the msd similarity matrix...\n",
            "Done computing similarity matrix.\n",
            "Computing the msd similarity matrix...\n",
            "Done computing similarity matrix.\n",
            "Computing the msd similarity matrix...\n",
            "Done computing similarity matrix.\n",
            "Computing the msd similarity matrix...\n",
            "Done computing similarity matrix.\n",
            "Computing the msd similarity matrix...\n",
            "Done computing similarity matrix.\n"
          ]
        },
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>test_rmse</th>\n",
              "      <th>fit_time</th>\n",
              "      <th>test_time</th>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>Algorithm</th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "      <th></th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>SlopeOne</th>\n",
              "      <td>3.434656</td>\n",
              "      <td>0.032331</td>\n",
              "      <td>0.248332</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>KNNBaseline</th>\n",
              "      <td>3.455838</td>\n",
              "      <td>0.149939</td>\n",
              "      <td>1.837058</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>KNNWithMeans</th>\n",
              "      <td>3.460108</td>\n",
              "      <td>0.151324</td>\n",
              "      <td>1.538992</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>SVD</th>\n",
              "      <td>3.543204</td>\n",
              "      <td>1.068042</td>\n",
              "      <td>0.061634</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>KNNBasic</th>\n",
              "      <td>3.582009</td>\n",
              "      <td>0.154431</td>\n",
              "      <td>1.489026</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>SVDpp</th>\n",
              "      <td>3.837666</td>\n",
              "      <td>8.277009</td>\n",
              "      <td>0.328999</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>"
            ],
            "text/plain": [
              "              test_rmse  fit_time  test_time\n",
              "Algorithm                                   \n",
              "SlopeOne       3.434656  0.032331   0.248332\n",
              "KNNBaseline    3.455838  0.149939   1.837058\n",
              "KNNWithMeans   3.460108  0.151324   1.538992\n",
              "SVD            3.543204  1.068042   0.061634\n",
              "KNNBasic       3.582009  0.154431   1.489026\n",
              "SVDpp          3.837666  8.277009   0.328999"
            ]
          },
          "execution_count": 54,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "import pandas as pd\n",
        "from surprise import Reader\n",
        "from surprise import Dataset\n",
        "from surprise.model_selection import cross_validate\n",
        "from surprise import NormalPredictor\n",
        "from surprise import KNNBasic\n",
        "from surprise import KNNWithMeans\n",
        "from surprise import KNNWithZScore\n",
        "from surprise import KNNBaseline\n",
        "from surprise import SVD\n",
        "from surprise import BaselineOnly\n",
        "from surprise import SVDpp\n",
        "from surprise import NMF\n",
        "from surprise import SlopeOne\n",
        "from surprise import CoClustering\n",
        "from surprise.accuracy import rmse\n",
        "from surprise import accuracy\n",
        "from surprise.model_selection import train_test_split\n",
        "benchmark = []\n",
        "# Iterate over all algorithms\n",
        "for algorithm in [SVD(), SVDpp(), SlopeOne(), KNNBaseline(), KNNBasic(), KNNWithMeans()]:\n",
        "    # Perform cross validation\n",
        "    results = cross_validate(algorithm, data, measures=['RMSE'], cv=3, verbose=False)\n",
        "\n",
        "    # Get results & append algorithm name\n",
        "    tmp = pd.DataFrame.from_dict(results).mean(axis=0)\n",
        "    tmp = tmp.append(pd.Series([str(algorithm).split(' ')[0].split('.')[-1]], index=['Algorithm']))\n",
        "    benchmark.append(tmp)\n",
        "\n",
        "\n",
        "pd.DataFrame(benchmark).set_index('Algorithm').sort_values('test_rmse')"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "P8SO8JYcwvML"
      },
      "outputs": [],
      "source": [
        "\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "iHV9Mo7ywvML"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "D-GroQxQwvML"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "WTXqR4CFwvML"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "h7jHGs-CwvML"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "ZwLxk6Q6wvML"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "TvAbTRFHwvML"
      },
      "outputs": [],
      "source": []
    }
  ],
  "metadata": {
    "colab": {
      "provenance": [],
      "toc_visible": true
    },
    "kernelspec": {
      "display_name": "Python 3",
      "language": "python",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.8.3"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}